<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë…¸ì„ë¹›í•˜ë£¨ ì¢…í•© ì§„ë‹¨ ê²°ê³¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin:0;
        background:#f4f6fa;
        font-family:'Noto Sans KR',sans-serif;
    }

    .wrap {
        max-width:900px;
        margin:25px auto;
        padding:0 15px;
    }

    .card {
        background:white;
        padding:28px;
        border-radius:16px;
        box-shadow:0 6px 20px rgba(0,0,0,0.08);
        margin-bottom:20px;
    }

    .title {
        font-size:24px;
        font-weight:800;
        margin-bottom:8px;
        color:#0f4fff;
    }

    .sub {
        color:#6b7280;
        font-size:15px;
        margin-bottom:18px;
    }

    .pill {
        display:inline-block;
        background:#eef2ff;
        padding:7px 12px;
        border-radius:999px;
        margin-right:8px;
        margin-bottom:6px;
        font-size:13px;
        color:#3742b1;
    }
    .pill.red { background:#ffe7e7; color:#b91c1c; }
    .pill.amber { background:#fff3cd; color:#b54706; }

    h3 {
        font-size:19px;
        margin-top:20px;
        margin-bottom:12px;
        color:#333;
    }

    li {
        margin-bottom:8px;
        font-size:16px;
        line-height:1.45;
    }

    .btn {
        background:#0f4fff;
        color:white;
        padding:18px;
        border-radius:12px;
        text-align:center;
        font-size:18px;
        cursor:pointer;
        margin-top:18px;
        font-weight:600;
        box-shadow:0 4px 14px rgba(15,79,255,0.3);
        transition:0.3s;
    }
    .btn:hover {
        background:#285eff;
    }

    @media(max-width:480px){
        .card { padding:20px; }
        .title { font-size:22px; }
        li { font-size:15px; }
        .btn { font-size:17px; padding:16px; }
    }
</style>
</head>

<body>

<div class="wrap">

    <!-- âœ… ê²°ê³¼ í—¤ë” -->
    <div class="card">
        <div class="title">ğŸ’  ë…¸ì„ë¹›í•˜ë£¨ ì¢…í•© ì§„ë‹¨ ê²°ê³¼</div>
        <div class="sub">ì„ íƒí•œ ë¬¸í•­ì„ ê¸°ë°˜ìœ¼ë¡œ AIê°€ ë¶„ì„í•œ ì˜ˆì¸¡ ê²°ê³¼ì…ë‹ˆë‹¤.</div>

        <div id="pills"></div>
        <div id="summary" style="margin-top:15px;"></div>
    </div>

    <!-- âœ… ê¶Œì¥ ì¡°ì¹˜ -->
    <div class="card">
        <h3>âœ… ê¶Œì¥ ì¡°ì¹˜</h3>
        <div id="advice"></div>
    </div>

    <!-- âœ… ì§„ë£Œê³¼ ì•ˆë‚´ -->
    <div class="card">
        <h3>ğŸ¥ ê¶Œì¥ ì§„ë£Œê³¼</h3>
        <div id="dept"></div>
    </div>

    <!-- âœ… ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼ -->
    <div class="btn" onclick="location.href='/'">â† ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°</div>

</div>

<script>
(function(){
    // âœ… URL íŒŒë¼ë¯¸í„°ë¡œë¶€í„° payload íŒŒì‹±
    const params = new URLSearchParams(window.location.search);
    const payload = params.get("payload");
    if(!payload){
        document.body.innerHTML = "<h2 style='text-align:center;margin-top:50px;'>âš ï¸ ë¶„ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</h2>";
        return;
    }

    let data;
    try {
        data = JSON.parse(decodeURIComponent(payload));
    } catch(e) {
        document.body.innerHTML = "<h2 style='text-align:center;margin-top:50px;'>âš ï¸ ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜</h2>";
        return;
    }

    // âœ… ìœ„í—˜ë„ í‘œì‹œ
    const pillsEl = document.getElementById("pills");
    const sevClass =
        data.severity === "ë†’ìŒ" ? "red" :
        data.severity === "ì¤‘ê°„" ? "amber" : "";
    pillsEl.innerHTML = `
        <span class="pill">ì£¼ì œ: ${data.topic}</span>
        <span class="pill ${sevClass}">ìœ„í—˜ë„: ${data.severity}</span>
    `;

    // âœ… ìš”ì•½ ê²°ê³¼ í‘œì‹œ
    document.getElementById("summary").innerHTML =
        `<div style="font-size:17px;color:#333;line-height:1.6;">${data.summary}</div>`;

    // âœ… ì¡°ì¹˜ ë‚´ìš©
    document.getElementById("advice").innerHTML = data.advice
        ? "<ul>" + data.advice.map(a => `<li>${a}</li>`).join("") + "</ul>"
        : "<p>ë³„ë„ì˜ ê¶Œì¥ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>";

    // âœ… ì§„ë£Œê³¼ í‘œì‹œ
    document.getElementById("dept").innerHTML =
        `<div style="font-size:17px;">${data.dept}</div>`;
})();
</script>

</body>
</html>
