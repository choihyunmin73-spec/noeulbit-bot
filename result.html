<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë…¸ì„ë¹›í•˜ë£¨ AI ì¢…í•© ì§„ë‹¨ ê²°ê³¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        background:#f5f7fb;
        font-family:'Noto Sans KR',sans-serif;
        margin:0;
        color:#222;
    }
    .wrap {
        max-width:900px;
        margin:30px auto;
        padding:0 15px;
    }
    .card {
        background:#fff;
        border-radius:14px;
        box-shadow:0 3px 10px rgba(0,0,0,0.05);
        padding:25px;
        margin-bottom:18px;
    }
    .title {
        font-size:22px;
        font-weight:800;
        color:#0f4fff;
        margin-bottom:5px;
    }
    .subtitle {
        font-size:15px;
        color:#555;
        margin-bottom:12px;
    }
    .pill {
        display:inline-block;
        padding:7px 12px;
        border-radius:999px;
        background:#eef2ff;
        color:#3742b1;
        font-size:13px;
        margin-right:6px;
        margin-bottom:6px;
    }
    .pill.red { background:#ffe5e5; color:#b91c1c; }
    .pill.amber { background:#fff7e0; color:#b54706; }

    .section-title {
        font-size:17px;
        font-weight:700;
        margin-bottom:10px;
        display:flex;
        align-items:center;
        gap:6px;
    }

    .ai-summary { color:#333; line-height:1.6; font-size:16px; }
    .advice ul { margin:0; padding-left:18px; line-height:1.6; font-size:16px; }
    .advice li { margin-bottom:6px; }

    .alert {
        background:#fff9e6;
        border-left:4px solid #ffd43b;
        padding:12px 15px;
        border-radius:8px;
        color:#444;
        font-size:15px;
        margin-top:8px;
    }

    .tag-list { margin-top:8px; }
    .tag {
        display:inline-block;
        background:#e9efff;
        padding:7px 11px;
        border-radius:8px;
        font-size:13px;
        color:#3248a8;
        margin:4px 5px;
    }

    .btn {
        background:#0f4fff;
        color:white;
        padding:16px;
        border-radius:10px;
        text-align:center;
        font-size:17px;
        cursor:pointer;
        margin-top:22px;
        box-shadow:0 3px 10px rgba(15,79,255,0.25);
    }
    .btn:hover { background:#285eff; }
</style>
</head>
<body>

<div class="wrap">

    <!-- HEADER -->
    <div class="card">
        <div class="title">ğŸ’  ë…¸ì„ë¹›í•˜ë£¨ AI ì¢…í•© ì§„ë‹¨ ê²°ê³¼</div>
        <div class="subtitle">AI ë¶„ì„ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸ ë§ì¶¤í˜• ìƒíƒœë¥¼ ìš”ì•½í•©ë‹ˆë‹¤.</div>

        <div id="header-info"></div>
    </div>

    <!-- AI SUMMARY -->
    <div class="card">
        <div class="section-title">ğŸ©º AI ì¢…í•© ì§„ë‹¨ ìš”ì•½</div>
        <div id="summary" class="ai-summary"></div>
    </div>

    <!-- SELF CARE -->
    <div class="card">
        <div class="section-title">âœ… ì…€í”„ ì¼€ì–´ ê°€ì´ë“œ</div>
        <div id="advice" class="advice"></div>
    </div>

    <!-- ALERT -->
    <div class="card">
        <div class="section-title">âš ï¸ ìœ„í—˜ ì‹ í˜¸</div>
        <div id="alert" class="alert"></div>
    </div>

    <!-- SELECTED TAGS -->
    <div class="card">
        <div class="section-title">ğŸ§© ì„ íƒí•œ í•­ëª©</div>
        <div id="tags" class="tag-list"></div>
    </div>

    <!-- BUTTON -->
    <div class="btn" onclick="location.href='/'">â† ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°</div>

</div>

<script>
(function(){
    const params = new URLSearchParams(window.location.search);
    const payload = params.get("payload");

    if(!payload){
        document.body.innerHTML = "<h2 style='text-align:center;margin-top:60px;'>âš ï¸ ë¶„ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</h2>";
        return;
    }

    let data;
    try {
        data = JSON.parse(decodeURIComponent(payload));
    } catch(e){
        document.body.innerHTML = "<h2 style='text-align:center;margin-top:60px;'>âš ï¸ ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜</h2>";
        return;
    }

    // HEADER INFO
    const sevClass = data.severity === "ë†’ìŒ" ? "red" : data.severity === "ì¤‘ê°„" ? "amber" : "";
    document.getElementById("header-info").innerHTML = `
        <div>
            <span class="pill">ì£¼ì œ: ${data.topic}</span>
            <span class="pill ${sevClass}">ìœ„í—˜ë„: ${data.severity}</span>
        </div>
        <div style="margin-top:10px;">
            <b>ê¶Œì¥ ì¡°ì¹˜:</b> ${data.summary}<br>
            <b>ê¶Œì¥ ì§„ë£Œê³¼:</b> ${data.dept}
        </div>
    `;

    // SUMMARY
    document.getElementById("summary").textContent =
        `${data.topic} ê´€ë ¨ ì£¼ìš” ë¶€ìœ„ì˜ ìƒíƒœ ì´ìƒì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ ìƒíƒœì— ë”°ë¼ ${data.summary} ì´ í•„ìš”í•˜ë©°, ${data.dept} ë°©ë¬¸ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.`;

    // ADVICE
    if(data.advice && data.advice.length){
        document.getElementById("advice").innerHTML =
            "<ul>" + data.advice.map(v => `<li>${v}</li>`).join("") + "</ul>";
    } else {
        document.getElementById("advice").innerHTML = "ë³„ë„ì˜ ì…€í”„ ì¼€ì–´ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.";
    }

    // ALERT
    const alertEl = document.getElementById("alert");
    if(data.severity === "ë†’ìŒ"){
        alertEl.innerHTML = "âš ï¸ í˜„ì¬ ì‘ê¸‰ ìˆ˜ì¤€ì˜ ìœ„í—˜ ì‹ í˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ì˜ë£Œê¸°ê´€ ë°©ë¬¸ì´ í•„ìš”í•©ë‹ˆë‹¤.";
    } else if(data.severity === "ì¤‘ê°„"){
        alertEl.innerHTML = "ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì¦ìƒ ë³€í™”ë¥¼ ê¾¸ì¤€íˆ ê´€ì°°í•˜ì„¸ìš”.";
    } else {
        alertEl.innerHTML = "íŠ¹ë³„í•œ ì‘ê¸‰ ì‹ í˜¸ëŠ” ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
    }

    // SELECTED TAGS (ì„ íƒ í•­ëª©)
    const tagContainer = document.getElementById("tags");
    if(data.checks && data.checks.length){
        tagContainer.innerHTML = data.checks.map(c => `<span class='tag'>${c}</span>`).join("");
    } else {
        tagContainer.innerHTML = "<span class='tag'>ì„ íƒ í•­ëª© ì—†ìŒ</span>";
    }
})();
</script>

</body>
</html>
