<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë…¸ì„ë¹›í•˜ë£¨ ì¢…í•© ì§„ë‹¨ ê²°ê³¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin:0;
        background:#f5f7fb;
        font-family:'Noto Sans KR',sans-serif;
    }

    .wrap {
        max-width:920px;
        margin:25px auto;
    }

    .card {
        background:white;
        padding:28px;
        border-radius:16px;
        box-shadow:0 6px 20px rgba(0,0,0,0.08);
        margin-bottom:20px;
    }

    .title {
        font-size:24px;
        font-weight:800;
        margin-bottom:8px;
    }

    .sub {
        color:#6b7280;
        font-size:15px;
        margin-bottom:20px;
    }

    .pill {
        display:inline-block;
        background:#eef2ff;
        padding:7px 12px;
        border-radius:999px;
        margin-right:8px;
        margin-bottom:8px;
        font-size:13px;
        color:#3742b1;
    }

    .pill.red { background:#ffe7e7; color:#b91c1c; }
    .pill.amber { background:#fff3cd; color:#b54706; }

    h3 {
        font-size:20px;
        margin-top:15px;
        margin-bottom:12px;
        font-weight:700;
    }

    li { 
        margin-bottom:8px; 
        font-size:16px;
        line-height:1.5;
    }

    .btn {
        background:#2f6efc;
        color:white;
        padding:18px;
        border-radius:12px;
        text-align:center;
        font-size:18px;
        cursor:pointer;
        margin-top:18px;
    }

    #analysis {
        font-size:16px;
        line-height:1.65;
        color:#333;
        padding:8px 0;
    }

    /* âœ… ëª¨ë°”ì¼ ìµœì í™” */
    @media(max-width:480px){
        .wrap { margin:15px; }
        .card { padding:20px; }
        .title { font-size:22px; }
        h3 { font-size:18px; }
        li { font-size:16px; }
        .btn { font-size:18px; padding:16px; }
        #analysis { font-size:15px; }
    }
</style>
</head>

<body>

<div class="wrap">

    <!-- âœ… MAIN SUMMARY CARD -->
    <div class="card">
        <div class="title">ğŸ’  ë…¸ì„ë¹›í•˜ë£¨ ì¢…í•© ì§„ë‹¨ ê²°ê³¼</div>
        <div class="sub">ì„ íƒí•œ ë¬¸í•­ ê¸°ë°˜ìœ¼ë¡œ ì´ˆê¸° ê±´ê°• ìƒíƒœë¥¼ ì•ˆë‚´í•©ë‹ˆë‹¤.</div>

        <div id="pills"></div>

        <div id="summary" style="margin-top:15px;"></div>
    </div>

    <!-- âœ… ìƒì„¸ ë¶„ì„ ë³´ê³ ì„œ -->
    <div class="card">
        <h3>ğŸ©º ìƒì„¸ ë¶„ì„ ë³´ê³ ì„œ</h3>
        <div id="analysis"></div>
    </div>

    <!-- âœ… ì…€í”„ ì¼€ì–´ ê°€ì´ë“œ -->
    <div class="card">
        <h3>âœ… ì…€í”„ ì¼€ì–´ ê°€ì´ë“œ</h3>
        <ul id="tips"></ul>
    </div>

    <!-- âœ… ìœ„í—˜ ì‹ í˜¸ -->
    <div class="card">
        <h3>âš ï¸ ì§€ê¸ˆ ì¦‰ì‹œ í™•ì¸í•´ì•¼ í•  ì‹ í˜¸</h3>
        <ul id="redflags"></ul>
        <div id="rf-note" style="color:#d62828;font-size:14px;margin-top:8px;"></div>
    </div>

    <!-- âœ… ì‚¬ìš©ìê°€ ì„ íƒí•œ ë‹µë³€ -->
    <div class="card">
        <h3>ğŸ§¾ ì„ íƒí•œ í•­ëª©</h3>
        <div id="selected"></div>
    </div>

    <div class="btn" onclick="location.href='/'">â† ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°</div>

</div>

<script>
(function(){
    const q = new URLSearchParams(location.search);
    const raw = q.get("payload");
    let data = {};
    try { data = JSON.parse(decodeURIComponent(raw)); } catch(e){}

    /* âœ… í˜ì´ì§€ ìƒë‹¨ PILL */
    const pills = [];
    pills.push(`<span class="pill">ì£¼ì œ: ${data.topic}</span>`);

    const sevClass =
        data.severity === "ë†’ìŒ" ? "red" :
        data.severity === "ì¤‘ê°„" ? "amber" : "";

    pills.push(`<span class="pill ${sevClass}">ìœ„í—˜ë„: ${data.severity}</span>`);

    document.getElementById("pills").innerHTML = pills.join(" ");

    /* âœ… SUMMARY */
    document.getElementById("summary").innerHTML =
        `<div style="font-size:17px; line-height:1.6;">
            <b>ê¶Œì¥ ì¡°ì¹˜:</b> ${data.action}<br>
            <b>ê¶Œì¥ ì§„ë£Œê³¼:</b> ${data.dept}
        </div>`;

    /* âœ… ìƒì„¸ ë¶„ì„ ë³´ê³ ì„œ */
    const analysisText = `
        ${data.analysis.join("<br>")}
    `;
    document.getElementById("analysis").innerHTML = analysisText;

    /* âœ… ì…€í”„ ì¼€ì–´ */
    document.getElementById("tips").innerHTML =
        data.tips.map(t => `<li>${t}</li>`).join("");

    /* âœ… ìœ„í—˜ ì‹ í˜¸ */
    document.getElementById("redflags").innerHTML =
        data.redflags.length > 0
            ? data.redflags.map(r => `<li>${r}</li>`).join("")
            : "<li>íŠ¹ë³„í•œ ì‘ê¸‰ ì‹ í˜¸ ì—†ìŒ</li>";

    if(data.redflags.length > 0){
        document.getElementById("rf-note").innerText =
            "â€» ìœ„ ì¦ìƒ ë°œìƒ ì‹œ ì¦‰ì‹œ 119 ë˜ëŠ” ì‘ê¸‰ì‹¤ ë°©ë¬¸ í•„ìš”";
    }

    /* âœ… ì„ íƒí•œ í•­ëª© */
    document.getElementById("selected").innerHTML =
        data.checks.map(c => `<span class="pill">${c}</span>`).join(" ");

})();
</script>

</body>
</html>
