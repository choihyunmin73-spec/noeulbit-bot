<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë…¸ì„ë¹›í•˜ë£¨ ì¢…í•© ì§„ë‹¨ ê²°ê³¼</title>
<style>
  body{margin:0;font-family:'Noto Sans KR',sans-serif;background:#f5f7fb}
  .wrap{max-width:920px;margin:30px auto}
  .card{background:#fff;border-radius:16px;box-shadow:0 8px 20px rgba(0,0,0,.08);padding:28px}
  .h1{font-size:22px;font-weight:800;margin:0 0 6px}
  .sub{color:#64748b;margin-bottom:18px}
  .pill{display:inline-block;padding:6px 12px;border-radius:999px;font-size:13px;margin-right:8px}
  .pill.blue{background:#e8f0ff;color:#0f4fff}
  .pill.amber{background:#fff1cf;color:#b45309}
  .pill.red{background:#ffe5e5;color:#b91c1c}
  .box{background:#f1f6ff;border-radius:12px;padding:18px;margin:16px 0}
  h3{margin:18px 0 8px;font-size:18px}
  ul{margin:8px 0 0 18px;color:#1f2937}
  .btn{display:block;width:100%;text-align:center;background:#2f6efc;color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;margin-top:18px;cursor:pointer}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .muted{color:#6b7280;font-size:14px}
  .badge{display:inline-block;padding:4px 8px;border-radius:8px;background:#eef2ff;color:#3730a3;font-size:12px;margin-right:6px}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="h1">ğŸ’  ë…¸ì„ë¹›í•˜ë£¨ ì¢…í•© ì§„ë‹¨ ê²°ê³¼</div>
      <div class="sub">AIê°€ ì„ íƒí•˜ì‹  ë¬¸í•­ì„ ë°”íƒ•ìœ¼ë¡œ ì´ˆê¸° ê±´ê°• ìƒíƒœì™€ ì¡°ì¹˜ë¥¼ ì•ˆë‚´í•´ ë“œë¦½ë‹ˆë‹¤.</div>

      <div id="headerPills"></div>

      <div class="box" id="summaryBox"></div>

      <div class="grid">
        <div class="card">
          <h3>âœ… ì…€í”„ ì¼€ì–´ ê°€ì´ë“œ</h3>
          <ul id="tipList"></ul>
        </div>
        <div class="card">
          <h3>âš ï¸ ì´ëŸ° ì¦ìƒì´ë©´ ì¦‰ì‹œ ì¡°ì¹˜</h3>
          <ul id="rfList"></ul>
          <p class="muted" id="rfNote"></p>
        </div>
      </div>

      <div class="card">
        <h3>ğŸ§¾ ì„ íƒí•œ í•­ëª©</h3>
        <div id="chipArea"></div>
      </div>

      <button class="btn" onclick="location.href='/'">â† ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°</button>
    </div>
  </div>

<script>
(function(){
  // payload ë¥¼ URLë¡œ ì „ë‹¬ë°›ìŒ
  const q = new URLSearchParams(location.search);
  const raw = q.get("payload") || "{}";
  let data = {};
  try { data = JSON.parse(decodeURIComponent(raw)); } catch(e){}

  // í—¤ë” í•„
  const pills = [];
  pills.push(`<span class="pill blue">ì£¼ì œ: ${data.topic || 'â€”'}</span>`);
  const sevClass = data.severity === 'ë†’ìŒ' ? 'red' : data.severity === 'ì¤‘ê°„' ? 'amber' : 'blue';
  pills.push(`<span class="pill ${sevClass}">ìœ„í—˜ë„: ${data.severity || 'â€”'}</span>`);
  document.getElementById('headerPills').innerHTML = pills.join(' ');

  // ìš”ì•½
  const sum = `
    <div><span class="badge">ê¶Œì¥ ì¡°ì¹˜</span> ${data.action || ''}</div>
    <div style="margin-top:6px;"><span class="badge">ê¶Œì¥ ì§„ë£Œê³¼</span> ${data.dept || ''}</div>
  `;
  document.getElementById('summaryBox').innerHTML = sum;

  // íŒ
  const tips = (data.tips || []).map(t => `<li>${t}</li>`).join('') || '<li>í•´ë‹¹ ì—†ìŒ</li>';
  document.getElementById('tipList').innerHTML = tips;

  // ë ˆë“œí”Œë˜ê·¸
  const rfs = (data.redflags || []).map(r => `<li>${r}</li>`).join('') || '<li>íŠ¹ë³„í•œ ì‘ê¸‰ ê²½ê³  ì—†ìŒ</li>';
  document.getElementById('rfList').innerHTML = rfs;
  document.getElementById('rfNote').innerText =
    (data.redflags && data.redflags.length) ? "â€» ìœ„ ì¦ìƒ ë°œìƒ ì‹œ ì§€ì²´ ì—†ì´ 119 ë˜ëŠ” ì‘ê¸‰ì‹¤ ë°©ë¬¸ì„ ê¶Œí•©ë‹ˆë‹¤." : "";

  // ì„ íƒ í•­ëª© ì¹©
  const chips = (data.checks || []).map(c => `<span class="pill blue" style="margin-bottom:8px;">${c}</span>`).join(' ');
  document.getElementById('chipArea').innerHTML = chips || '<span class="muted">ì„ íƒ í•­ëª© ì—†ìŒ</span>';
})();
</script>
</body>
</html>
