<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI 진단 결과</title>
  <style>
    body {
      font-family: "Pretendard", "Noto Sans KR", sans-serif;
      background-color: #0d1420;
      color: #fff;
      margin: 0;
      padding: 0;
      text-align: center;
      min-height: 100vh;
    }

    h1 {
      color: #6ba7ff;
      margin-top: 40px;
      font-size: 1.9em;
    }

    .box {
      background: #182539;
      border-radius: 14px;
      border: 1px solid #294e80;
      width: 85%;
      max-width: 750px;
      margin: 40px auto;
      padding: 30px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      text-align: left;
    }

    .topic {
      color: #9fc3ff;
      font-size: 1.3em;
      text-align: center;
      margin-bottom: 20px;
    }

    .bar {
      height: 8px;
      background: #22324b;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 6px;
      margin-bottom: 18px;
    }
    .bar span {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, #5b8cff, #6fe1ff);
      width: 0%;
      transition: width 0.8s ease;
    }

    .btns {
      text-align: center;
      margin-top: 35px;
    }

    button {
      background: #5b8cff;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 12px 22px;
      margin: 8px;
      font-size: 1em;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background: #6fa8ff;
      transform: translateY(-2px);
    }

    footer {
      color: #7f9bbd;
      font-size: 0.85em;
      margin-bottom: 25px;
    }

    .product {
      background: #1c2d46;
      border: 1px solid #315d93;
      border-radius: 10px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 15px;
    }

    .product img {
      width: 42px;
      height: 42px;
      border-radius: 8px;
    }

    .product a {
      color: #9fc3ff;
      text-decoration: none;
      font-weight: 500;
    }

    .product a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>AI 진단 결과</h1>

  <div class="box">
    <div class="topic" id="topic">주제: -</div>

    <p id="summary"></p>

    <p><b>총 응답 수:</b> <span id="count">0</span>개</p>
    <p><b>위험도 감지 단어 수:</b> <span id="riskCount">0</span>개</p>

    <p><b>위험도 지표:</b> <span id="risk">0</span>/100</p>
    <div class="bar"><span id="riskBar"></span></div>

    <div id="message"></div>

    <div id="product"></div>

    <div class="btns">
      <button onclick="goHome()">처음으로 돌아가기</button>
      <button onclick="retry()">다시 진단하기</button>
    </div>
  </div>

  <footer>© 2025 노을빛하루 AI 진단 시스템</footer>

  <script>
    const data = JSON.parse(localStorage.getItem("aiResult") || "{}");

    document.getElementById("topic").innerText = `주제: ${data.topic || "알 수 없음"}`;
    document.getElementById("count").innerText = data.totalAnswers ?? 0;
    document.getElementById("riskCount").innerText = data.riskCount ?? 0;

    const risk = data.riskPercent ?? 0;
    document.getElementById("risk").innerText = risk;
    document.getElementById("riskBar").style.width = `${risk}%`;

    // 메시지 표시
    document.getElementById("message").innerHTML =
      data.message || "현재 상태는 비교적 양호합니다.<br>규칙적인 생활습관을 유지하세요.";

    // 제휴상품 표시
    if (data.product) {
      const box = document.getElementById("product");
      box.innerHTML = `
        <div class="product">
          <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji/assets/svg/1f48a.svg" alt="product">
          <div>
            <b>${data.product.title}</b><br>
            ${data.product.desc}<br>
            <a href="${data.product.link}" target="_blank">쿠팡 바로가기</a>
          </div>
        </div>
      `;
    }

    function goHome() {
      localStorage.clear();
      window.location.href = "index.html";
    }

    function retry() {
      const topic = data.topic ? encodeURIComponent(data.topic) : "";
      localStorage.removeItem("aiResult");
      window.location.href = `question.html?topic=${topic}`;
    }
  </script>
</body>
</html>
