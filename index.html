<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…¸ì„ë¹›í•˜ë£¨ ë¬´ë£Œ ê±´ê°• ì²´í¬</title>

    <style>
        body {
            font-family: "Pretendard", sans-serif;
            background: #f5f6fa;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 720px;
            margin: 30px auto;
            background: #fff;
            border-radius: 14px;
            padding: 28px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        h2 {
            margin: 0 0 10px 0;
            font-size: 26px;
            font-weight: 700;
        }

        .sub {
            color: #777;
            margin-bottom: 25px;
            font-size: 15px;
            line-height: 1.4;
        }

        .topic-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .topic-btn, .opt-btn {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            background: #eef2ff;
            border-radius: 10px;
            border: 1px solid #e0e6ff;
            cursor: pointer;
            text-align: center;
            transition: 0.25s;
        }

        .topic-btn:hover, .opt-btn:hover {
            background: #dce5ff;
        }

        .q-title {
            font-size: 19px;
            margin: 15px 0;
            font-weight: 600;
        }

        .loading-box {
            padding: 25px;
            background: #f5f5f7;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
            font-size: 17px;
        }

        .result-box {
            background: #f8f9fc;
            padding: 22px;
            border-radius: 12px;
            margin-top: 18px;
            white-space: pre-line;
            line-height: 1.5;
            border: 1px solid #e7e9f3;
        }

        .back-btn {
            margin-top: 20px;
            display: inline-block;
            padding: 12px 18px;
            background: #e9e9e9;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
        }

        .back-btn:hover {
            background: #d7d7d7;
        }
    </style>
</head>

<body>

<div class="container">

    <h2>ğŸ”¹ ë…¸ì„ë¹›í•˜ë£¨ ë¬´ë£Œ ê±´ê°• ì²´í¬</h2>
    <div class="sub">
        ì•„ë˜ ì§ˆë¬¸ì„ ì„ íƒí•˜ë©´, AIê°€ ë¬´ë£Œë¡œ ê±´ê°• ìƒíƒœë¥¼ ì²´í¬í•˜ê³  í•„ìš”í•œ ì •ë³´ë¥¼ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
    </div>

    <div id="app"></div>

</div>

<script>
/* âœ… 1) ì „ì²´ ì£¼ì œ */
const TOPICS = [
    { id:"joint", label:"ë¬´ë¦Â·ê´€ì ˆ" },
    { id:"bp", label:"í˜ˆì••" },
    { id:"sugar", label:"í˜ˆë‹¹Â·ë‹¹ë‡¨" },
    { id:"sleep", label:"ë¶ˆë©´ì¦Â·ìˆ˜ë©´" },
    { id:"scam", label:"ë³´ì´ìŠ¤í”¼ì‹±" },
    { id:"welfare", label:"ë³µì§€Â·ì§€ì›ê¸ˆ" },
    { id:"phone", label:"ìŠ¤ë§ˆíŠ¸í° ë¬¸ì œ" },
    { id:"insurance", label:"ì‹œë‹ˆì–´ ë³´í—˜Â·ê±´ê°•ë³´í—˜" }
];


/* âœ… 2) ì£¼ì œë³„ ì§ˆë¬¸ ì„¸íŠ¸ */
const QUESTIONS = {
    joint: [
        { q: "ì–´ë–¤ ë¶ˆí¸ì´ ìˆë‚˜ìš”?", opts: ["ê³„ë‹¨ í†µì¦","ê±·ê¸°/ì•‰ì•˜ë‹¤ ì¼ì–´ì„¤ ë•Œ í†µì¦","ì‘¤ì‹¬/ë»ê·¼í•¨","ìš´ë™ í›„ í†µì¦","ê¸°íƒ€/ëª¨ë¦„"] },
        { q: "í†µì¦ ê¸°ê°„ì€ ì–´ëŠ ì •ë„ì¸ê°€ìš”?", opts: ["1ì£¼ ë¯¸ë§Œ","1~4ì£¼","1~3ê°œì›”","3ê°œì›” ì´ìƒ","ì˜ ëª¨ë¥´ê² ìŒ"] },
        { q: "í†µì¦ ê°•ë„ëŠ” ì–´ëŠ ì •ë„ì¸ê°€ìš”?", opts: ["ì•½í•¨","ì¤‘ê°„","ì‹¬í•¨","ë§¤ìš° ì‹¬í•¨"] },
        { q: "ì–´ë–¤ ìƒí™©ì—ì„œ ì•…í™”ë˜ë‚˜ìš”?", opts: ["ê±·ê¸°","ê³„ë‹¨","ìª¼ê·¸ë ¤ ì•‰ê¸°","ì¥ì‹œê°„ ì„œ ìˆê¸°","íŠ¹ë³„íˆ ì—†ìŒ"] }
    ],

    bp: [
        { q:"ìµœê·¼ í˜ˆì•• ì¸¡ì • ì‹œê¸°", opts:["1ì£¼ ì´ë‚´","1ê°œì›” ì´ë‚´","3ê°œì›” ì´ë‚´","ê¸°ì–µ ì•ˆë‚¨"] },
        { q:"ê³ í˜ˆì•• ì•½ ë³µìš© ì—¬ë¶€", opts:["ë³µìš© ì¤‘","ì²˜ë°©ë°›ì•˜ìœ¼ë‚˜ ì¤‘ë‹¨","ë³µìš© ì•ˆ í•¨"] },
        { q:"í‰ì†Œ í˜ˆì•• ìˆ˜ì¹˜", opts:["ì •ìƒ","ê²½ê³„","ë†’ìŒ","ì˜ ëª¨ë¥´ê² ìŒ"] },
        { q:"ì–´ë–¤ ì¦ìƒì´ ìˆë‚˜ìš”?", opts:["ì–´ì§€ëŸ¼ì¦","ë‘í†µ","ì–¼êµ´ ë¶‰ì–´ì§","íŠ¹ë³„í•œ ì¦ìƒ ì—†ìŒ","ê°€ìŠ´ ë‘ê·¼ê±°ë¦¼"] }
    ],

    sugar: [
        { q:"ìµœê·¼ ê³µë³µ í˜ˆë‹¹ì€?", opts:["70~99","100~125","126 ì´ìƒ","ê¸°ì–µ ì•ˆë‚¨"] },
        { q:"ë‹¹ë‡¨ì•½ ë³µìš© ì—¬ë¶€", opts:["ë³µìš© ì¤‘","ì²˜ë°©ë°›ì•˜ìœ¼ë‚˜ ì¤‘ë‹¨","ë³µìš© ì•ˆ í•¨"] },
        { q:"ì‹í›„ 2ì‹œê°„ í˜ˆë‹¹ì€?", opts:["140 ë¯¸ë§Œ","140~179","180 ì´ìƒ","ê¸°ì–µ ì•ˆë‚¨"] },
        { q:"ì¦ìƒ ì—¬ë¶€", opts:["ì¦ì€ ê°ˆì¦","ì†Œë³€ ì¦ê°€","ì²´ì¤‘ ë³€í™”","í”¼ë¡œê°","íŠ¹ë³„í•œ ì¦ìƒ ì—†ìŒ"] }
    ],

    sleep: [
        { q:"ì ë“¤ê¸°ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„", opts:["30ë¶„ ì´í•˜","30~60ë¶„","60ë¶„ ì´ìƒ","ê¸°ì–µ ì•ˆë‚¨"] },
        { q:"ìˆ˜ë©´ ì¤‘ ê¹¨ëŠ” íšŸìˆ˜", opts:["0~1íšŒ","2~3íšŒ","4íšŒ ì´ìƒ"] },
        { q:"ì•„ì¹¨ ê¸°ë¶„ì€ ì–´ë–¤ê°€ìš”?", opts:["ê°œìš´í•¨","í”¼ê³¤í•¨","ë‘í†µ","ì§‘ì¤‘ë ¥ ì €í•˜"] },
        { q:"ìˆ˜ë©´ ë°©í•´ ìš”ì¸", opts:["ìŠ¤íŠ¸ë ˆìŠ¤","í†µì¦","ê±±ì •/ìƒê°","ì†ŒìŒ","íŠ¹ë³„í•œ ìš”ì¸ ì—†ìŒ"] }
    ],

    scam: [
        { q:"ì–´ë–¤ ìƒí™©ì´ ì˜ì‹¬ë˜ë‚˜ìš”?", opts:["ì€í–‰/ì •ë¶€ê¸°ê´€","ëŒ€ì¶œ ê¶Œìœ ","ê°€ì¡± ì‚¬ì¹­","ë‚©ì¹˜/ìœ„í˜‘","ê¸°íƒ€"] },
        { q:"ê¸ˆì „ ìš”êµ¬ ì—¬ë¶€", opts:["ìš”êµ¬í•¨","ìš”êµ¬ ì•ˆ í•¨"] },
        { q:"ê°œì¸ì •ë³´ ì…ë ¥ ì—¬ë¶€", opts:["ì…ë ¥í•¨","ì…ë ¥ ì•ˆ í•¨"] },
        { q:"í”¼í•´ ê°€ëŠ¥ì„±", opts:["ë§¤ìš° ì˜ì‹¬ë¨","ì•½ê°„ ì˜ì‹¬ë¨","ê´œì°®ì€ ë“¯","ëª¨ë¥´ê² ìŒ"] }
    ],

    welfare: [
        { q:"í˜„ì¬ ìƒí™©", opts:["ë§Œ 65ì„¸ ì´ìƒ","ê¸°ì´ˆì—°ê¸ˆ ëŒ€ìƒ","ì°¨ìƒìœ„/í•œë¶€ëª¨","í•´ë‹¹ ì—†ìŒ"] },
        { q:"ê±´ê°•ë³´í—˜ ë“±ê¸‰", opts:["ì§€ì—­ê°€ì…ì","ì§ì¥ê°€ì…ì","ì°¨ìƒìœ„/ì˜ë£Œê¸‰ì—¬","ì˜ ëª¨ë¥´ê² ìŒ"] },
        { q:"í•„ìš”í•œ ì§€ì› ë¶„ì•¼", opts:["ì˜ë£Œë¹„","ì£¼ê±°","ìƒê³„","ëŒë´„","ê¸°íƒ€"] },
        { q:"í˜„ì¬ ê³ ë¯¼", opts:["ì˜ë£Œë¹„ ì¦ê°€","ì›”ì„¸/ì£¼ê±°ë¹„","ìƒí™œë¹„ ë¶€ì¡±","ë³´ì¥/ë³´í—˜ ë¶€ì¡±","ìƒë‹´ í•„ìš”"] }
    ],

    phone: [
        { q:"ì–´ë–¤ ë¬¸ì œê°€ ìˆë‚˜ìš”?", opts:["ì†ë„ ëŠë¦¼","ì‚¬ì§„/ì˜ìƒ ë¬¸ì œ","ë¬¸ì ì˜¤ë¥˜","ì „í™” ë¬¸ì œ","ê¸°íƒ€"] },
        { q:"ì‚¬ìš© ê¸°ì¢…", opts:["ì•„ì´í°","ê°¤ëŸ­ì‹œ","ê¸°íƒ€"] },
        { q:"ì¦ìƒ ê¸°ê°„", opts:["1ì£¼ ë¯¸ë§Œ","1ì£¼~1ê°œì›”","1ê°œì›” ì´ìƒ"] },
        { q:"ì–´ë–¤ í˜„ìƒì´ ë‚˜íƒ€ë‚˜ë‚˜ìš”?", opts:["ì•± ì¢…ë£Œ","í™”ë©´ ë©ˆì¶¤","ë°ì´í„° ì†Œì§„","ì €ì¥ê³µê°„ ë¶€ì¡±","ì˜ ëª¨ë¥´ê² ìŒ"] }
    ],

    insurance: [
        { q:"í˜„ì¬ ë³´í—˜ ìƒíƒœ", opts:["ì—¬ëŸ¬ ê°œ ìˆìŒ","1ê°œ ìˆìŒ","ê±°ì˜ ì—†ìŒ","ëª¨ë¥´ê² ìŒ"] },
        { q:"í˜„ì¬ ê³ ë¯¼", opts:["ë³´ì¥ ë¶€ì¡±","ë³´í—˜ ê°±ì‹ /í•´ì§€","ë³´í—˜ë£Œ ë¶€ë‹´","ìƒë‹´ í•„ìš”"] },
        { q:"ìµœê·¼ ê±´ê°• ì§„ë‹¨ ì—¬ë¶€", opts:["ìµœê·¼ ì§„ë‹¨ ë°›ìŒ","1ë…„ ë‚´ ë°›ìŒ","ë°›ì€ ì  ì—†ìŒ"] },
        { q:"ê´€ì‹¬ í•­ëª©", opts:["ì‹¤ë¹„ë³´í—˜","ì•”ë³´í—˜","ì¹˜ë§¤ë³´í—˜","ê±´ê°•ë³´í—˜","ëª¨ë¥´ê² ìŒ"] }
    ]
};


/* âœ… 3) í™”ë©´ ìƒíƒœ */
let state = {
    topic: null,
    step: 0,
    answers: []
};


/* âœ… í™”ë©´ ë Œë”ë§ */
const app = document.getElementById("app");


/* âœ… ì²« í™”ë©´ â€“ ì£¼ì œ ì„ íƒ */
function renderTopics() {
    state = { topic:null, step:0, answers:[] };

    app.innerHTML = `
        <div class="q-title">í™•ì¸í•˜ê³  ì‹¶ì€ í•­ëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš” ğŸ˜Š</div>
        <div class="topic-grid">
            ${TOPICS.map(t => `
                <button class="topic-btn" onclick="selectTopic('${t.id}')">${t.label}</button>
            `).join("")}
        </div>
    `;
}


/* âœ… ì£¼ì œ ì„ íƒ ì²˜ë¦¬ */
function selectTopic(id) {
    state.topic = id;
    state.step = 0;
    state.answers = [];
    renderQuestion();
}


/* âœ… ì§ˆë¬¸ ë Œë”ë§ */
function renderQuestion() {
    const qSet = QUESTIONS[state.topic];
    const curr = qSet[state.step];

    app.innerHTML = `
        <div class="q-title">Q${state.step + 1}. ${curr.q}</div>
        ${curr.opts.map(op => `
            <button class="opt-btn" onclick="selectAnswer('${op}')">${op}</button>
        `).join("")}

        <div class="back-btn" onclick="renderTopics()">â† ì²˜ìŒìœ¼ë¡œ</div>
    `;
}


/* âœ… ë‹µë³€ ì„ íƒ í›„ ë‹¤ìŒ ë‹¨ê³„ */
function selectAnswer(ans) {
    state.answers.push(ans);
    state.step++;

    if (state.step >= QUESTIONS[state.topic].length) {
        sendToAI();
    } else {
        renderQuestion();
    }
}


/* âœ… AI ì„œë²„ì— ë¶„ì„ ìš”ì²­ */
async function sendToAI() {
    app.innerHTML = `<div class="loading-box">AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤â€¦ ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” â³</div>`;

    try {
        const res = await fetch("/ai-analyze", {
            method: "POST",
            headers: { "Content-Type":"application/json" },
            body: JSON.stringify({
                topic: state.topic,
                answers: state.answers
            })
        });

        const data = await res.json();

        app.innerHTML = `
            <h3>âœ… AI ë¶„ì„ ê²°ê³¼</h3>
            <div class="result-box">${data.result}</div>
            <div class="back-btn" onclick="renderTopics()">â† ë‹¤ì‹œ ì‹œì‘</div>
        `;

    } catch (err) {
        app.innerHTML = `
            <div class="result-box">âŒ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.<br>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</div>
            <div class="back-btn" onclick="renderTopics()">â† ì²˜ìŒìœ¼ë¡œ</div>
        `;
    }
}


/* âœ… ì´ˆê¸° ì‹¤í–‰ */
renderTopics();
</script>

</body>
</html>
