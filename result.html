<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>AI ì§„ë‹¨ ê²°ê³¼</title>
<style>
  :root {
    --bg:#0d1420;--panel:#121a26;--panel2:#182235;
    --line:#2a3a55;--brand:#6ba7ff;--muted:#9fb1cf;--white:#fff;
  }
  body {
    font-family:"Pretendard","Noto Sans KR",sans-serif;
    background:var(--bg);color:var(--white);margin:0;
  }
  .wrap {
    display:flex;flex-wrap:wrap;justify-content:space-between;
    max-width:1180px;margin:0 auto;padding:40px 60px;
  }
  .left,.right {
    background:var(--panel2);border:1px solid var(--line);
    border-radius:12px;padding:28px;
    box-sizing:border-box;
  }
  .left {flex:0 0 63%;min-width:340px;}
  .right {flex:0 0 32%;min-width:300px;}
  h1 {margin:10px 0 25px;color:#98c2ff;font-size:1.6em;}
  h2 {margin-top:32px;color:#bcd4ff;font-size:1.25em;}
  p {line-height:1.6em;margin:8px 0;color:#dbe3f7;}

  /* ìœ„í—˜ë„ ê·¸ë˜í”„ */
  .risk-graph {
    margin:20px 0 26px;height:16px;
    background:#22324b;border-radius:8px;overflow:hidden;
  }
  .risk-fill {
    height:100%;background:linear-gradient(90deg,#5b8cff,#6ba7ff);
    width:0;transition:width .8s ease;
  }

  /* ì œíœ´ìƒí’ˆÂ·ë³´í—˜ */
  .item-box {
    background:#1a263b;border:1px solid #294e80;
    border-radius:10px;padding:14px 16px;margin-bottom:16px;
    color:#dce8ff;transition:.2s;
  }
  .item-box:hover {
    background:#27406b;border-color:#5b8cff;
  }
  .item-box .icon {font-size:1.4em;margin-bottom:8px;}
  .item-box a {
    color:#84b8ff;text-decoration:none;
    display:inline-block;margin-top:6px;
  }
  .small-note {
    font-size:0.85em;color:#7a8cad;margin-top:20px;
    text-align:center;
  }

  @media (max-width:900px) {
    .wrap {flex-direction:column;padding:25px;}
    .left,.right {flex:1 1 100%;margin-bottom:20px;}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="left">
      <h1>AI ê±´ê°• ì§„ë‹¨ ê²°ê³¼</h1>
      <div id="result-summary"></div>

      <div class="risk-graph"><div class="risk-fill" id="risk-bar"></div></div>

      <h2>ìƒì„¸ ì§„ë‹¨</h2>
      <div id="detail"></div>

      <h2>ìš”ì•½</h2>
      <div id="summary"></div>

      <h2>ì „ë¬¸ê°€ ì˜ê²¬</h2>
      <div id="expert"></div>
    </div>

    <div class="right">
      <h2>ì¶”ì²œ ì œíœ´ìƒí’ˆ</h2>
      <div id="affiliate-products"></div>

      <h2>ì¶”ì²œ ì œíœ´ë³´í—˜</h2>
      <div id="affiliate-insurance"></div>

      <p class="small-note">ë³¸ ì œíœ´ìƒí’ˆ ë° ì œíœ´ë³´í—˜ì€ ì†Œì •ì˜ ìˆ˜ìˆ˜ë£Œë¥¼ ì§€ê¸‰ë°›ìŠµë‹ˆë‹¤.</p>
    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const topic = localStorage.getItem("aiTopic");
  const answers = JSON.parse(localStorage.getItem("aiAnswers") || "[]");

  if (!topic || answers.length === 0) {
    document.body.innerHTML = "<h2 style='color:#6ba7ff;text-align:center;margin-top:100px;'>ì§„ë‹¨ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</h2>";
    return;
  }

  // ìœ„í—˜ ë‹¨ì–´ ë° ì ìˆ˜ ê³„ì‚°
  const riskWords = ["ì‹¬í•¨","ìœ„í—˜","í†µì¦","ì €ë¦¼","ê°‘ìê¸°","ìˆ¨","ì••ë°•","ë¶ˆì•ˆ","ë‘í†µ","ì–´ì§€ëŸ¼"];
  let riskCount = 0;
  answers.forEach(ans => riskWords.forEach(rw => { if(ans.includes(rw)) riskCount++; }));
  const riskScore = Math.min(100, riskCount * 12);
  const riskLevel = riskScore >= 70 ? "High" : riskScore >= 35 ? "Moderate" : "Mild";

  document.getElementById("result-summary").innerHTML = `
    <p>í˜„ì¬ ì£¼ì œ: <strong>${topic}</strong></p>
    <p>ì´ ì‘ë‹µ ìˆ˜: ${answers.length}ê°œ</p>
    <p>ìœ„í—˜ ë‹¨ì–´ ìˆ˜: ${riskCount}ê°œ</p>
    <p>ìœ„í—˜ë„ ì§€í‘œ: ${riskScore}/100 (${riskLevel})</p>
  `;

  document.getElementById("risk-bar").style.width = riskScore + "%";

  /* ìƒì„¸ ì§„ë‹¨ ìë™ ìƒì„± */
  const detail = document.getElementById("detail");
  let detailText = "";
  if (riskLevel === "High") {
    detailText = `
      í˜„ì¬ ìƒíƒœëŠ” ì£¼ì˜ê°€ í•„ìš”í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì¦‰ì‹œ ì „ë¬¸ì˜ ìƒë‹´ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
      ì¦ìƒì´ ë°˜ë³µë˜ê±°ë‚˜ ì‹¬í™”ë  ê²½ìš° ë³‘ì› ë‚´ì›ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
      ê³¼ë¡œì™€ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ í”¼í•˜ê³  ì¶©ë¶„í•œ íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”.
      ìˆ˜ë©´ íŒ¨í„´ì´ ë¶ˆê·œì¹™í•˜ë‹¤ë©´ ì¦‰ì‹œ ì¡°ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
      í†µì¦ ë˜ëŠ” ë¶ˆí¸ê°ì´ ìˆë‹¤ë©´ ì¦‰ì‹œ ì§„ë£Œë¥¼ ê¶Œí•©ë‹ˆë‹¤.
      ì‹ìŠµê´€ ê°œì„ ê³¼ ê·œì¹™ì ì¸ ìš´ë™ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
      2~3ì¼ ë‚´ì— ë³‘ì› ë°©ë¬¸ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
      ìƒí™œê´€ë¦¬ì™€ ì˜ì–‘ë³´ì¶©ì„ ë³‘í–‰í•˜ì„¸ìš”.
      ìˆ˜ë¶„ ì„­ì·¨ë¥¼ ì¶©ë¶„íˆ ìœ ì§€í•˜ì„¸ìš”.
      ìƒíƒœ ë³€í™”ê°€ ì§€ì†ë˜ë©´ ì¦‰ì‹œ ë‚´ì›í•˜ì„¸ìš”.
      ë¬´ë¦¬í•œ í™œë™ì€ í”¼í•˜ê³  íœ´ì‹ì— ì§‘ì¤‘í•˜ì„¸ìš”.
      í˜ˆì••, í˜ˆë‹¹, ì²´ì˜¨ ë³€í™”ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”.
      í•„ìš”ì‹œ ë³µìš© ì¤‘ì¸ ì•½ì„ ì˜ì‚¬ì™€ ìƒì˜í•˜ì„¸ìš”.
      ì •ì‹ ì  ì•ˆì •ì„ ìœ„í•œ ëª…ìƒë„ ë„ì›€ì´ ë©ë‹ˆë‹¤.
      ë¹ ë¥¸ ì‹œì¼ ë‚´ ì „ë¬¸ ì˜ë£Œì§„ ìƒë‹´ì„ ë°›ìœ¼ì„¸ìš”.
    `;
  } else if (riskLevel === "Moderate") {
    detailText = `
      ì¼ë¶€ ê²½ë¯¸í•œ ì´ìƒ ì§•í›„ê°€ ê´€ì°°ë˜ì—ˆìŠµë‹ˆë‹¤.
      ìƒí™œìŠµê´€ ì¡°ì •ê³¼ íœ´ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.
      ìŠ¤íŠ¸ë ˆìŠ¤ ì™„í™”ì™€ ì¶©ë¶„í•œ ìˆ˜ë©´ì„ í™•ë³´í•˜ì„¸ìš”.
      ì¦ìƒì´ ë©°ì¹  ì´ìƒ ì§€ì†ë˜ë©´ ë³‘ì› ë‚´ì›ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
      ê·œì¹™ì ì¸ ìš´ë™ê³¼ ê· í˜• ì¡íŒ ì‹ë‹¨ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
      í†µì¦ ë¶€ìœ„ê°€ ìˆë‹¤ë©´ ëƒ‰ì˜¨ì°œì§ˆì„ ë³‘í–‰í•˜ì„¸ìš”.
      3ì¼ ë‚´ë¡œ ìƒíƒœë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.
      ë¬´ë¦¬í•œ í™œë™ì€ í”¼í•˜ê³ , íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”.
      ì†Œí™”ë‚˜ ìˆœí™˜ì— ë¬¸ì œê°€ ìˆë‹¤ë©´ ì¡°ê¸° ê²€ì‚¬ í•„ìš”.
      ìƒí™œê´€ë¦¬ì™€ ìˆ˜ë¶„ ì„­ì·¨ë¥¼ ë³‘í–‰í•˜ì„¸ìš”.
      ì¦ìƒ ì•…í™” ì‹œ ì¦‰ì‹œ ë³‘ì› ë°©ë¬¸ì„ ê³ ë ¤í•˜ì„¸ìš”.
      ê¾¸ì¤€í•œ ì˜ì–‘ ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.
      ì¦ìƒì´ ì™„í™”ë˜ì§€ ì•Šìœ¼ë©´ ì „ë¬¸ì˜ ìƒë‹´ ê¶Œì¥.
      ì²´ë ¥ íšŒë³µ í›„ì—ë„ ì£¼ê¸°ì  ê´€ë¦¬ê°€ ì¢‹ìŠµë‹ˆë‹¤.
      ì „ë°˜ì ìœ¼ë¡œ ì¤‘ê°„ ìˆ˜ì¤€ì˜ ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.
    `;
  } else {
    detailText = `
      í˜„ì¬ ìƒíƒœëŠ” ì–‘í˜¸í•©ë‹ˆë‹¤.
      íŠ¹ë³„í•œ ìœ„í—˜ ë‹¨ì–´ê°€ ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
      ê·œì¹™ì ì¸ ìƒí™œê³¼ ì¶©ë¶„í•œ ìˆ˜ë©´ì„ ìœ ì§€í•˜ì„¸ìš”.
      ì¼ìƒì ì¸ ê±´ê°•ê´€ë¦¬ë¡œ ì¶©ë¶„íˆ íšŒë³µ ê°€ëŠ¥í•©ë‹ˆë‹¤.
      ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ìµœì†Œí™”í•˜ê³  ê¸ì •ì ì¸ ë§ˆì¸ë“œë¥¼ ê°€ì§€ì„¸ìš”.
      ê·œì¹™ì ì¸ ìš´ë™ì„ í†µí•´ ì‹ ì²´ ë°¸ëŸ°ìŠ¤ë¥¼ ìœ ì§€í•˜ì„¸ìš”.
      ê±´ê°•ì‹í’ˆì´ë‚˜ ì˜ì–‘ì œ ì„­ì·¨ë„ ë„ì›€ì´ ë©ë‹ˆë‹¤.
      ì¼ì‹œì ì¸ í”¼ë¡œëŠ” íœ´ì‹ìœ¼ë¡œ ê°œì„ ë©ë‹ˆë‹¤.
      ì¦ìƒ ì¬ë°œ ì‹œ ì „ë¬¸ê°€ ìƒë‹´ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
      ì£¼ê¸°ì ì¸ ê²€ì§„ìœ¼ë¡œ ìƒíƒœë¥¼ ì ê²€í•˜ì„¸ìš”.
      ê°€ë²¼ìš´ ì‚°ì±…ì´ë‚˜ ìš”ê°€ê°€ ë„ì›€ì´ ë©ë‹ˆë‹¤.
      ìˆ˜ë¶„ ì„­ì·¨ë¥¼ ê¾¸ì¤€íˆ ìœ ì§€í•˜ì„¸ìš”.
      ìƒíƒœê°€ ì•ˆì •ì ì¼ ê²½ìš° ë³„ë„ ì¡°ì¹˜ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
      ìƒí™œê´€ë¦¬ì™€ ê²½ê³¼ ê´€ì°°ì„ ë³‘í–‰í•˜ì„¸ìš”.
      ì „ë°˜ì ìœ¼ë¡œ ê±´ê°• ìƒíƒœëŠ” ì–‘í˜¸í•©ë‹ˆë‹¤.
    `;
  }
  detail.innerHTML = detailText.split("\n").map(t => `<p>${t.trim()}</p>`).join("");
  /* ìš”ì•½ ë° ì „ë¬¸ê°€ ì˜ê²¬ */
  const summary = document.getElementById("summary");
  const expert = document.getElementById("expert");

  summary.innerHTML = `
    <p>ì£¼ì œ: ${topic}</p>
    <p>ìœ„í—˜ë„ ìˆ˜ì¤€: ${riskLevel}</p>
    <p>ì‘ë‹µ ìˆ˜: ${answers.length}ê°œ</p>
    <p>ì „ë°˜ì ìœ¼ë¡œ ${riskLevel === "Mild" ? "ì•ˆì •ì ì´ë©°, ìƒí™œê´€ë¦¬ ì¤‘ì‹¬ì˜ ì ‘ê·¼ì´ ê¶Œì¥ë©ë‹ˆë‹¤." :
       riskLevel === "Moderate" ? "ì£¼ì˜ê°€ í•„ìš”í•˜ë©°, ìƒí™œìŠµê´€ ì¡°ì •ê³¼ ì •ê¸°ê²€ì§„ì„ ë³‘í–‰í•˜ì„¸ìš”." :
       "ì¦‰ê°ì ì¸ ì§„ë£Œì™€ ì „ë¬¸ì˜ ìƒë‹´ì´ í•„ìš”í•©ë‹ˆë‹¤."}</p>
    <p>ê·œì¹™ì ì¸ ìš´ë™ê³¼ ìˆ˜ë¶„ ì„­ì·¨ê°€ ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>
    <p>ì¦ìƒ ì§€ì† ì‹œ ì˜ë£Œê¸°ê´€ ë°©ë¬¸ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
    <p>í•„ìš”ì‹œ ê´€ë ¨ ì „ë¬¸ì˜ ìƒë‹´ì„ ë°›ìœ¼ì„¸ìš”.</p>
  `;

  expert.innerHTML = `
    <p>AI ë¶„ì„ ê²°ê³¼, ${riskLevel === "High" ? "ì‹¬ê°í•œ ìœ„í—˜ìš”ì†Œê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤." : 
      riskLevel === "Moderate" ? "ì¤‘ê°„ ìˆ˜ì¤€ì˜ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤." : 
      "íŠ¹ë³„í•œ ìœ„í—˜ìš”ì†ŒëŠ” í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."}</p>
    <p>ì§€ì†ì ì¸ ìƒí™œê´€ë¦¬ì™€ ì •ê¸° ê²€ì§„ìœ¼ë¡œ ê±´ê°•ì„ ìœ ì§€í•˜ì„¸ìš”.</p>
  `;

  /* ì œíœ´ìƒí’ˆ & ë³´í—˜ ë¡œë“œ */
  try {
    const res = await fetch("affiliate.json");
    const data = await res.json();
    const prodBox = document.getElementById("affiliate-products");
    const insBox = document.getElementById("affiliate-insurance");
    prodBox.innerHTML = "";
    insBox.innerHTML = "";

    if (data[topic]?.products) {
      data[topic].products.forEach(p => {
        const box = document.createElement("div");
        box.className = "item-box";
        box.innerHTML = `
          <div class="icon">ğŸ›ï¸</div>
          <div class="name"><b>${p.name}</b></div>
          <div class="desc">${p.desc || ""}</div>
          <a href="${p.link}" target="_blank">ì¿ íŒ¡ ë°”ë¡œê°€ê¸°</a>
        `;
        prodBox.appendChild(box);
      });
    }

    if (data[topic]?.insurance) {
      data[topic].insurance.forEach(p => {
        const box = document.createElement("div");
        box.className = "item-box";
        box.innerHTML = `
          <div class="icon">ğŸ’¼</div>
          <div class="name"><b>${p.name}</b></div>
          <div class="desc">${p.desc || ""}</div>
          <a href="${p.link}" target="_blank">ë³´í—˜ ë°”ë¡œê°€ê¸°</a>
        `;
        insBox.appendChild(box);
      });
    }
  } catch (e) {
    console.error("ì œíœ´ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜", e);
  }
});
</script>
</body>
</html>
