<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ë…¸ì„ë¹›í•˜ë£¨ AI ì§„ë‹¨ ê²°ê³¼</title>
<style>
body{margin:0;font-family:'Noto Sans KR',sans-serif;background:#f6f8fb}
.container{max-width:900px;margin:20px auto;padding:20px}
.card{background:#fff;border-radius:14px;padding:22px;margin-bottom:15px;box-shadow:0 4px 15px rgba(0,0,0,0.06)}
.title{font-size:22px;font-weight:700;margin-bottom:8px}
.sub{color:#6b7280;font-size:14px;margin-bottom:15px}
.pill{display:inline-block;background:#eef2ff;color:#3742b1;padding:5px 10px;border-radius:999px;margin:2px;font-size:13px}
.pill.red{background:#ffe7e7;color:#b91c1c}
.pill.amber{background:#fff3cd;color:#b54706}
h3{font-size:17px;margin:12px 0}
li{font-size:15px;line-height:1.45;margin-bottom:6px}
.btn{background:#2f6efc;color:#fff;text-align:center;padding:16px;border-radius:10px;font-size:17px;cursor:pointer}
@media(max-width:480px){.container{margin:10px}.card{padding:18px}.title{font-size:20px}}
</style>
</head>
<body>
<div class="container">

<div class="card">
  <div class="title">ğŸ’  ë…¸ì„ë¹›í•˜ë£¨ AI ì¢…í•© ì§„ë‹¨ ê²°ê³¼</div>
  <div class="sub">AI ë¶„ì„ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸ ë§ì¶¤í˜• ìƒíƒœë¥¼ ìš”ì•½í•©ë‹ˆë‹¤.</div>
  <div id="pills"></div>
  <div id="summary" style="margin-top:10px"></div>
</div>

<div class="card">
  <h3>ğŸ©º AI ì¢…í•© ì§„ë‹¨ ìš”ì•½</h3>
  <div id="ai-summary" style="font-size:15px;line-height:1.5;color:#222"></div>
</div>

<div class="card">
  <h3>âœ… ì…€í”„ ì¼€ì–´ ê°€ì´ë“œ</h3>
  <ul id="tips"></ul>
</div>

<div class="card">
  <h3>âš ï¸ ìœ„í—˜ ì‹ í˜¸</h3>
  <ul id="redflags"></ul>
  <div id="rf-note" style="color:#d62828;font-size:13px;margin-top:6px"></div>
</div>

<div class="card">
  <h3>ğŸ§¾ ì„ íƒí•œ í•­ëª©</h3>
  <div id="selected"></div>
</div>

<div class="btn" onclick="location.href='/'">â† ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°</div>

</div>

<script>
(function(){
  const p=new URLSearchParams(location.search);
  const raw=p.get("payload"); let data={};
  try{data=JSON.parse(decodeURIComponent(raw));}catch(e){console.error("ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜",e);}
  const pills=[];
  pills.push(`<span class="pill">ì£¼ì œ: ${data.topic}</span>`);
  const sevClass=data.severity==="ë†’ìŒ"?"red":data.severity==="ì¤‘ê°„"?"amber":"";
  pills.push(`<span class="pill ${sevClass}">ìœ„í—˜ë„: ${data.severity}</span>`);
  document.getElementById("pills").innerHTML=pills.join(" ");

  document.getElementById("summary").innerHTML=
  `<div><b>ê¶Œì¥ ì¡°ì¹˜:</b> ${data.action}</div><div><b>ê¶Œì¥ ì§„ë£Œê³¼:</b> ${data.dept}</div>`;

  const summaryTxt=data.aiSummary||`${data.topic} ê´€ë ¨ ì£¼ìš” ë¶€ìœ„ì˜ ìƒíƒœ ì´ìƒì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ ìƒíƒœì— ë”°ë¼ ${data.action}ì´ í•„ìš”í•˜ë©°, ${data.dept} ë°©ë¬¸ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.`;
  document.getElementById("ai-summary").innerText=summaryTxt;

  document.getElementById("tips").innerHTML=data.tips.map(t=>`<li>${t}</li>`).join("");

  if(data.redflags?.length){
    document.getElementById("redflags").innerHTML=data.redflags.map(r=>`<li>${r}</li>`).join("");
    document.getElementById("rf-note").innerText="â€» ìœ„ ì¦ìƒì´ ì§€ì†ë˜ë©´ ì¦‰ì‹œ ì „ë¬¸ì˜ ì§„ë£Œê°€ í•„ìš”í•©ë‹ˆë‹¤.";
  }else{
    document.getElementById("redflags").innerHTML="<li>íŠ¹ë³„í•œ ì‘ê¸‰ ì‹ í˜¸ëŠ” ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</li>";
  }

  document.getElementById("selected").innerHTML=(data.checks||[]).map(c=>`<span class="pill">${c}</span>`).join(" ");
})();
</script>
</body>
</html>
